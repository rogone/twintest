// Code generated by github.com/rogone/twintest
package {{ .PackageName }}

import (
	"testing"
	"github.com/stretchr/testify/suite"
)

{{if .HasSuite}}
type {{ .Receiver }}TestSuite struct {
	suite.Suite
}
{{end}}

{{range .TestCases}}
{{if .IsMethod}}
func (suite *{{ .Receiver }}TestSuite) Test_{{ .Name }}(t *testing.T) {
{{else}}
func Test_{{ .Name }}(t *testing.T) {
{{end}}
{{- range .Branches }}
{{ template "branch" (dict "Branch" . "Indent" 1) }}
{{- end }}
}
{{end}}

{{if .HasSuite}}
func Test{{ .Receiver }}TestSuite(t *testing.T) {
	suite.Run(t, new({{ .Receiver }}TestSuite))
}
{{end}}

{{define "branch"}}
{{ $indent := .Indent }}
{{ $tabs := repeat "\t" $indent }}
{{ $name := printf "line:%d: %s" .Branch.Line (quote .Branch.CodeLine) }}
{{ $tabs }}t.Run({{ $name }}, func(t *testing.T) {
{{- range .Branch.Children }}
{{ template "branch" (dict "Branch" . "Indent" (add $indent 1)) }}
{{- end }}
{{ $tabs }})
{{end}}